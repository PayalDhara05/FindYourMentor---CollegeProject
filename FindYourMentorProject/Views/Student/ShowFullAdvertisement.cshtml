@model FindYourMentorProject.Models.BigModel

@{
    ViewBag.Title = "ShowFullAdvertisement";
    Layout = "~/Views/Shared/_StudentLayout.cshtml";
}

<link href="~/Custom/css/ViewAdvertisement.css" rel="stylesheet" />
<body>
    <div class="main-course-advert">
        <div class="indiv-course-advert">
            <div class="advert-heading">
                <h1>Teaching @Model.CourseAdvertisement.CourseName Courses in @Model.CourseAdvertisement.City</h1>
                <i class="fas fa-heart" title="Add to saved list"></i>
            </div>

            <div class="mode-info">
                <div class="Course-name">
                    <i class="fas fa-user"> Mentor/ Mentor's</i>
                    <p>@Model.CourseAdvertisement.MentorName</p>
                </div>
                @if (!string.IsNullOrEmpty(Model.CourseAdvertisement.logo))
                {
                    <img src="@Url.Content(Model.CourseAdvertisement.logo)" alt="logo" />
                }
            </div>

            <div class="Course-main-info">
                <div class="Course-name">
                    <i class="fas fa-home"> Mode</i>
                    <p>@Model.CourseAdvertisement.Mode</p>
                </div>

                <div class="Course-name">
                    <i class="fas fa-book-reader"> Courses</i>
                    <p>@Model.CourseAdvertisement.CourseName</p>
                </div>

                <div class="Course-name">
                    <i class="fas fa-school"> Class Name</i>
                    <p>@Model.CourseAdvertisement.ClassName</p>
                </div>
            </div>



            <div class="student-info">
                <div class="seats">
                    <i class="far fa-play-circle"> Start Date</i>
                    <p>@Model.CourseAdvertisement.StartDate</p>
                </div>

                <div class="seats">
                    <i class="far fa-calendar"> Duration</i>
                    <p>@Model.CourseAdvertisement.Duration Months</p>
                </div>

                <div class="seats">
                    <i class="far fa-money-bill-alt"> Fees</i>
                    <p>&#x20B9; @Model.CourseAdvertisement.Fees</p>
                </div>

                <div class="seats">
                    <i class="fas fa-chalkboard-teacher"> Experience</i>
                    <p>@Model.CourseAdvertisement.YearsOfExperience</p>
                </div>
            </div>

            <div class="student-info">
                <div class="seats">
                    <i class="fas fa-user-graduate"> Total Seats</i>
                    <p>@Model.CourseAdvertisement.TotalSeats</p>
                </div>

                <div class="seats">
                    <i class="fas fa-user-graduate"> Available Seats</i>
                    <p>@Model.CourseAdvertisement.SeatsOccupied</p>
                </div>

                <div class="seats">
                    <i class="fas fa-user-graduate"> Available Batches</i>
                    <p>@Model.CourseAdvertisement.BatchesAvailable</p>
                </div>

                <div class="seats">
                    <i class="fas fa-user-graduate"> Filled Batches</i>
                    <p>@Model.CourseAdvertisement.BatchesFull</p>
                </div>
            </div>

            <div class="class-info">
                <div class="github">
                    <i class="fab fa-github"> GitHub</i>
                    <p>@Model.CourseAdvertisement.GitHubAccount</p>
                </div>

                <div class="github">
                    <i class="fab fa-linkedin"> LinkedIn</i>
                    <p>@Model.CourseAdvertisement.LinkedIn</p>
                </div>
            </div>

            <div class="description">
                <h2>About @Model.CourseAdvertisement.ClassName</h2>
                <p>@Model.CourseAdvertisement.Description</p>
            </div>

            <div class="address-info">
                <div class="seats" id="address">
                    <i class="fas fa-map-marker-alt"> Address</i>
                    <p>@Model.CourseAdvertisement.Address</p>
                </div>

                <div class="seats">
                    <i class="fas fa-location-arrow"> State</i>
                    <p>@Model.CourseAdvertisement.State</p>
                </div>

                <div class="seats">
                    <i class="fas fa-building"> City</i>
                    <p>@Model.CourseAdvertisement.City</p>
                </div>
            </div>

            <div class="communication">
                <i class="fas fa-language"> Communication Languages</i>
                <p>@Model.CourseAdvertisement.SpokenLanguage1  @Model.CourseAdvertisement.SpokenLanguage2  @Model.CourseAdvertisement.SpokenLanguage3  @Model.CourseAdvertisement.SpokenLanguage4</p>
            </div>

            <div class="demo-videos">
                <i class="fas fa-video"> Demo Lectures</i>
                <div class="indiv-vid">
                    <video controls>
                        <source src="@Url.Content(Model.CourseAdvertisement.DemoLec1)" type="video/mp4" id="videoPreview2" class="all-videos" />
                    </video>
                    <video controls>
                        <source src="@Url.Content(Model.CourseAdvertisement.DemoLec2)" type="video/mp4" id="videoPreview2" class="all-videos" />
                    </video>
                    <video controls>
                        <source src="@Url.Content(Model.CourseAdvertisement.DemoLec3)" type="video/mp4" id="videoPreview2" class="all-videos" />
                    </video>
                    <video controls>
                        <source src="@Url.Content(Model.CourseAdvertisement.DemoLec4)" type="video/mp4" id="videoPreview2" class="all-videos" />
                    </video>
                </div>
            </div>

            <div class="Feedback-box">
                <p>Feedback</p>
                <div class="all-feedbacks">
                    @if (@Model.Feedback.Count() == 0)
                    {
                        <div class="empty-feedback">
                            <p>No Feedbacks posted</p>
                        </div>
                    }
                    else
                    {
                        foreach (var item in Model.Feedback)
                        {
                            <div class="indiv-feedback">
                                <p>@item.commentedOn.ToString() By <span>@item.Username</span></p>
                                <p>@item.feedbackDescription</p>
                                <div class="all-stars">
                                    @for (int i = 0; i < @item.Rating; i++)
                                    {
                                        <i class="fas fa-star"></i>
                                    }
                                    @for (int i = 5; i > @item.Rating; i--)
                                    {
                                        <i class="far fa-star"></i>
                                    }
                                </div>
                            </div>
                        }
                    }

                </div>
            </div>

            <div class="post-feedback">
                <p> Please write down your feedback</p>
                <form action="/Student/postFeedback" method="post">
                    <textarea rows="4" cols="36" id="feedbackDescription" name="feedbackDescription" placeholder="Write your review :)"></textarea>
                    <div class="all-rating">
                        <i class="far fa-star" id="span1" onclick="CRateClick(1)"></i>
                        <i class="far fa-star" id="span2" onclick="CRateClick(2)"></i>
                        <i class="far fa-star" id="span3" onclick="CRateClick(3)"></i>
                        <i class="far fa-star" id="span4" onclick="CRateClick(4)"></i>
                        <i class="far fa-star" id="span5" onclick="CRateClick(5)"></i>
                    </div>
                    <div>
                        <input type="hidden" name="rating" value="0" id="lblRating" />
                    </div>
                    <div>
                        <input type="hidden" name="AdvertisementID" value="@ViewBag.ID" />
                    </div>
                    <input type="submit" name="saveButton" value="Post Your Feedback" />
                </form>
            </div>

            <div class="comment-section" id="comment-section">
                <p>Comments</p>
                <div class="comment-box">
                    <div class="indiv-comment">
                        @if (@Model.Comment.Count() == 0)
                        {
                            <div class="empty-feedback">
                                <p>No Comments posted</p>
                            </div>
                        }
                        else
                        {
                            foreach (var item in Model.Comment)
                            {
                                <div class="indiv-feedback">
                                    <p>@item.commentedDate By <span>@item.mentorName</span></p>
                                    <p>@item.Message</p>
                                </div>

                                <div class="comment-btn">
                                    <button onclick="showReplybox(@item.CommentID)">Reply to this comment</button>
                                </div>
                                <div class="reply-comment-form" id="@item.CommentID">
                                    <form onsubmit="postReply(this,@item.CommentID)" id="@item.CommentID-comment-form">
                                        <textarea name="Message" cols="30" rows="10" placeholder="Type your comment ..." id="@item.CommentID-textarea"></textarea>
                                        <input type="hidden" name="AdvertisementID" value="@ViewBag.ID" id="@item.AdvertisementID-Advertisement" />
                                        <input type="hidden" name="CommentID" value="@item.CommentID" id="@item.CommentID-Comment" />
                                        <input type="submit" value="Submit Reply">
                                    </form>
                                </div>
                                <div class="reply-comment-section">
                                    @foreach (var inneritem in Model.ReplyToComment)
                                    {
                                        if (inneritem.CommentID == item.CommentID)
                                        {
                                            <div class="indiv-reply">
                                                <p>Replied to @item.mentorName:By @inneritem.MentorName</p>
                                                <p>@inneritem.Message</p>
                                            </div>
                                        }

                                    }
                                </div>
                            }
                        }
                    </div>
                </div>

                <div class="post-comment">
                    <form action="/Student/postComment" method="post">
                        <textarea name="Message" id="textarea" cols="30" rows="10" placeholder="Type your comment ..."></textarea>
                        <input type="hidden" name="AdvertisementID" value="@ViewBag.ID" />
                        <input type="submit" value="Post your comment">
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">

        function CRateClick(rating) {
            var ratingData = $('#lblRating').val(rating);
            var value = "span" + rating;
            var bool = document.getElementById(value).classList.contains('far');
            if (bool) {
                for (var i = 1; i <= rating; i++) {
                    $("#span" + i).attr('class', 'fas fa-star');
                    ratingData = +$('#lblRating').val() - 1 + 1;
                }
            }
            else {
                for (var i = 5; i >= rating; i--) {
                    $("#span" + i).attr('class', 'far fa-star');
                    ratingData = +$('#lblRating').val() - 1
                }
            }
            console.log(ratingData);
            document.getElementById("lblRating").value = ratingData;
        }

        function showReplybox(id) {
            $("#" + id).css('display', 'block');
            $(".post-comment").css('display', 'none');
        }

        function postReply(form, id) {
            $(".reply-comment-form").css('display', 'none');
            $(".post-comment").css('display', 'block');
            var val = document.getElementById(id + "-textarea").value;
            var formdata = $("#"+id+"-comment-form").serialize();
            $.ajax({
                url: '/Student/postReply' + '?val=' + val,
                method: 'post',
                data: formdata
            })
        }
    </script>
</body>
